apiVersion: fis.fis.dksshddl.dev/v1alpha1
kind: ExperimentTemplate
metadata:
  name: network-latency-experiment
  namespace: default
spec:
  description: "Inject increasing network latency on nginx pods"
  
  targets:
  - name: nginx-pods
    namespace: default
    labelSelector:
      app: nginx
    selectionMode: ALL
  
  actions:
  - name: low-latency
    type: pod-network-latency
    duration: 5m
    target: nginx-pods
    parameters:
      delayMilliseconds: "200"
  
  - name: medium-latency
    type: pod-network-latency
    duration: 5m
    target: nginx-pods
    parameters:
      delayMilliseconds: "400"
    startAfter:
    - low-latency
  
  - name: high-latency
    type: pod-network-latency
    duration: 5m
    target: nginx-pods
    parameters:
      delayMilliseconds: "600"
    startAfter:
    - medium-latency
  
  stopConditions:
  - source: none
  
  tags:
  - key: Name
    value: "EKS Stress: Network Latency"
  - key: Environment
    value: "test"
